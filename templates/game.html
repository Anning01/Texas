{% extends "base.html" %}

{% block title %}å¾·å·æ‰‘å…‹ - {{ room_name }}{% endblock %}

{% block content %}
<div class="game-page">
    <!-- é¡¶éƒ¨ä¿¡æ¯æ  -->
    <header class="game-header">
        <div class="room-info">
            <span class="room-name">ğŸƒ {{ room_name }}</span>
            <span class="room-id">ID: {{ room_id }}</span>
        </div>
        <div class="game-info">
            <span class="stage" id="stage">ç­‰å¾…ä¸­</span>
            <span class="pot">åº•æ± : <strong id="pot">0</strong></span>
            <span class="blinds" id="blinds"></span>
        </div>
        <div class="header-right">
            <div class="timer-display" id="timer-display" style="display:none;">
                <span class="timer-icon">â±ï¸</span>
                <span class="timer-value" id="timer-value">30</span>
            </div>
            <form action="/leave-room/{{ room_id }}" method="post" class="leave-form">
                <button type="submit" class="btn btn-leave">ç¦»å¼€</button>
            </form>
        </div>
    </header>

    <div class="game-body">
        <!-- æ¸¸æˆæ¡Œé¢ -->
        <main class="poker-table">
            <!-- å…¬å…±ç‰ŒåŒºåŸŸ -->
            <div class="community-section">
                <div class="community-cards" id="community-cards">
                    <div class="card card-placeholder"></div>
                    <div class="card card-placeholder"></div>
                    <div class="card card-placeholder"></div>
                    <div class="card card-placeholder"></div>
                    <div class="card card-placeholder"></div>
                </div>
                <div class="pot-display">
                    <span class="pot-label">åº•æ± </span>
                    <span class="pot-value" id="pot-display">0</span>
                </div>
            </div>

            <!-- ç©å®¶åŒºåŸŸ -->
            <div class="players-area" id="players-area">
                <!-- åŠ¨æ€ç”Ÿæˆç©å®¶ä½ç½® -->
            </div>
        </main>

        <!-- ä¾§è¾¹æ ï¼šèŠå¤©å’Œå†å² -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-tabs">
                <button class="tab-btn active" data-tab="chat">ğŸ’¬ èŠå¤©</button>
                <button class="tab-btn" data-tab="history">ğŸ“œ è®°å½•</button>
            </div>
            
            <div class="tab-content" id="tab-chat">
                <div class="chat-messages" id="chat-messages">
                    <!-- èŠå¤©æ¶ˆæ¯ -->
                </div>
                <div class="chat-input-area">
                    <input type="text" id="chat-input" placeholder="è¾“å…¥æ¶ˆæ¯..." maxlength="200">
                    <button class="btn btn-send" id="btn-send">å‘é€</button>
                </div>
            </div>
            
            <div class="tab-content" id="tab-history" style="display:none;">
                <div class="action-history" id="action-history">
                    <!-- æ“ä½œå†å² -->
                </div>
            </div>
        </aside>
    </div>

    <!-- åº•éƒ¨æ“ä½œåŒº -->
    <footer class="action-bar" id="action-bar">
        <div class="my-hand" id="my-hand">
            <!-- æˆ‘çš„æ‰‹ç‰Œ -->
        </div>
        
        <div class="my-info" id="my-info">
            <span class="my-chips">ğŸ’° <span id="my-chips">0</span></span>
        </div>
        
        <div class="actions" id="actions">
            <!-- æˆ¿ä¸»å¼€å§‹æŒ‰é’® æˆ– ç­‰å¾…æç¤º -->
            <div class="waiting-actions" id="waiting-actions">
                <button class="btn btn-start" id="btn-start" style="display:none;">å¼€å§‹æ¸¸æˆ</button>
                <p class="waiting-text" id="waiting-text">ç­‰å¾…æ›´å¤šç©å®¶åŠ å…¥...</p>
            </div>
            
            <!-- æ¸¸æˆä¸­çš„æ“ä½œæŒ‰é’® -->
            <div class="game-actions" id="game-actions" style="display:none;">
                <button class="btn btn-fold" id="btn-fold">å¼ƒç‰Œ</button>
                <button class="btn btn-check" id="btn-check">è¿‡ç‰Œ</button>
                <button class="btn btn-call" id="btn-call">è·Ÿæ³¨ <span id="call-amount"></span></button>
                <div class="raise-group">
                    <input type="range" id="raise-slider" min="0" max="1000" value="0">
                    <input type="number" id="raise-amount" min="0" value="0">
                    <button class="btn btn-bet" id="btn-bet">ä¸‹æ³¨</button>
                    <button class="btn btn-raise" id="btn-raise">åŠ æ³¨</button>
                </div>
                <button class="btn btn-allin" id="btn-allin">å…¨æŠ¼</button>
            </div>
        </div>
    </footer>

    <!-- ç»“æœå¼¹çª— -->
    <div class="modal" id="result-modal" style="display:none;">
        <div class="modal-content">
            <h2>ğŸ† æœ¬å±€ç»“æœ</h2>
            <div class="winners-list" id="winners-list"></div>
            <button class="btn btn-primary" id="btn-close-modal">ç¡®å®š</button>
        </div>
    </div>
    
    <!-- ç§»åŠ¨ç«¯ä¾§è¾¹æ åˆ‡æ¢æŒ‰é’® -->
    <button class="sidebar-toggle" id="sidebar-toggle">ğŸ’¬</button>
</div>
{% endblock %}

{% block scripts %}
<script>
    const ROOM_ID = "{{ room_id }}";
    const PLAYER_ID = "{{ player_id }}";
    const PLAYER_NAME = "{{ player_name }}";
</script>
<script src="/static/js/game.js"></script>
{% endblock %}
